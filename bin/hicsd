#!/usr/bin/env python3

"""HiC sunt dracones - Your little helper for the HiC analysis"""

import argparse
import hicsuntdracones.submatrix

__author__ = "Konrad Foerstner <konrad@foerstner.org>"
__copyright__ = "2017 by Konrad Foerstner <konrad@foerstner.org>"
__license__ = "ISC license"
__email__ = "konrad@foerstner.org"
__version__ = "0.1.0"


def main():
    parser = argparse.ArgumentParser()
    subparsers = parser.add_subparsers(help="commands")

    show_version_parser = subparsers.add_parser(
        "version", help="Show version")
    show_version_parser.set_defaults(func=show_version)
    
    shape_parser = subparsers.add_parser(
        "shape", help="Return the shape of the matrix")
    shape_parser.set_defaults(func=shape)

    submatrix_parser = subparsers.add_parser(
        "submatrix", help="Extract submatrices")
    submatrix_parser.set_defaults(func=submatrix)
    submatrix_parser.add_argument(
        "--matrix", "-m", dest="matrix_file", required=True)
    submatrix_parser.add_argument("--output_prefix", "-o", required=True)
    submatrix_parser.add_argument("--chromosome", "-c")
    submatrix_parser.add_argument("--delimiter", "-d", default="-")
    
    args = parser.parse_args()
    if "func" in dir(args):
        args.func(args)
    else:
        parser.print_help()

def show_version():
    print(__version__)

def shape():
    pass

def submatrix(args):
    hicsuntdracones.submatrix.extract(
        args.matrix_file, args.output_prefix, args.chromosome, args.delimiter)

main()
